---
title: "Lab 4 Deliverable"
author: "Yukun Guo"
date: "4/27/2022"
output: html_document
---

```{r, echo=FALSE}
library(tidyverse)
library(readxl)
library(gapminder)
library(countrycode)
```


# Lab 4 Deliverable

## Part 1: Tidying
```{r}
gapmnd_un_tidy <- read_excel('data/gapminder_broadband_per_100.xlsx')
gapmnd <- gapmnd_un_tidy|> janitor::clean_names()
colnames(gapmnd)[1] <- 'country'
gapmnd 

gapmnd |> 
  pivot_longer(-country,names_to = 'year',values_to="broadband") |>
  drop_na()
  
#gapmnd$continent <- countrycode(sourcevar = gapmnd$country,
#                            origin = "country.name",
#                            destination = "continent")
```

## Part 2: Gapminder

Recall the Task Menu:

* Get the maximum and minimum of GDP per capita for all continents.

* Look at the spread of GDP per capita across countries within the continents.

* How does life expectancy vary across different continents?

* Report the absolute and/or relative abundance of countries with low life expectancy over time by continent: Compute some measure of worldwide life expectancy - you decide - a mean or median or some other quantile or perhaps your current age. Then determine how many countries on each continent have a life expectancy less than this benchmark, for each year.

* Make up your own! 

### Get the maximum and minimum of GDP per capita for all continents.


#### Table
```{r}
gapmnd_gdp <-gapminder |> 
  select(year, continent,gdpPercap)|>
  group_by(year,continent)|>
  summarise_if(is.numeric, funs(min,max),na.rm = TRUE)

gapmnd_gdp <- gapmnd_gdp|>pivot_longer(min:max, names_to = "Type", values_to="gdpPercap")
gapmnd_gdp
```
#### Companion Graph
```{r}
 ggplot(gapmnd_gdp,aes(x=year,y=gdpPercap, color=Type))+
  geom_point()+
  geom_line(aes(group=Type))+theme(axis.text.x = element_text( angle = 45))+
  facet_wrap(~continent, ncol=5)
```

#### Description/Writeup
This plot shows the max and min GDP  per capita for all continents and the change over year

###  How does life expectancy vary across different continents?

#### Table
```{r}
df <-gapminder |>
  select(country,continent,year,lifeExp)
df
```

#### Companion Graph
```{r}
ggplot(df,aes(x=year, y=lifeExp,group=interaction(continent, year),color=continent))+
  geom_boxplot()

```

#### Description/Writeup
This plot shows the life expectancy distribution for each continent over years. 
